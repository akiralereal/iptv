# Web 管理后台使用指南

## 快速开始

### 1. 启动服务

**Node.js 方式：**
```bash
node app.js
```

**Docker 方式：**
```bash
docker-compose up -d
```

### 2. 访问管理后台

- **无密码**：http://localhost:1234/admin
- **有密码**（如设置 `mpass=mypass`）：http://localhost:1234/mypass/admin

## 界面说明

### 左侧面板 - 所有频道

显示从直播源获取的所有频道，按分类组织：
- 央视频道
- 卫视频道  
- 地方台
- 其他频道

**功能：**
- 🔍 搜索框：快速查找频道
- ➕ 添加按钮：将频道添加到自定义分组

### 右侧面板 - 自定义分组

显示您创建的自定义频道分组。

**功能：**
- ➕ 新建分组：创建新的频道分组
- ✏️ 编辑：修改分组名称
- 🗑️ 删除：删除整个分组
- ✖️ 移除：从分组中移除单个频道

### 顶部控制栏

- **新建分组**：创建新的自定义分组
- **保存配置**：保存您的所有修改
- **启用自定义分组**：开关，决定是否使用自定义分组

## 使用场景示例

### 场景 1：创建"常看频道"

1. 点击 **"新建分组"**
2. 输入分组名称：`常看频道`
3. 在左侧搜索或浏览找到频道
4. 点击频道旁的 **"添加 ➜"** 按钮
5. 重复步骤 3-4 添加更多频道
6. 点击 **"保存配置"**

### 场景 2：按兴趣分组

创建多个分组，如：
- **新闻资讯**：CCTV1、CCTV13、凤凰中文
- **体育频道**：CCTV5、CCTV5+、广东体育
- **影视剧**：CCTV6、CCTV8、各大卫视
- **儿童频道**：CCTV14、卡酷动画、金鹰卡通

### 场景 3：家庭成员专属频道

- **爸爸的频道**：体育、新闻
- **妈妈的频道**：影视剧、综艺
- **孩子的频道**：少儿、动画

## 重要说明

### 启用/禁用自定义分组

- ❌ **未启用**：播放列表显示所有频道（原始分组）
- ✅ **已启用**：播放列表只显示自定义分组中的频道

### 配置保存

配置保存在 `custom-channels.json` 文件中：
```json
{
  "enableCustomGroups": true,
  "customGroups": [
    {
      "name": "常看频道",
      "channels": ["CCTV1综合", "CCTV5体育", ...]
    }
  ],
  "excludeChannels": []
}
```

### Docker 环境

配置会自动保存在容器内。如果需要持久化，可以挂载配置文件：

```yaml
services:
  iptv:
    image: akiralereal/iptv:latest
    volumes:
      - ./custom-channels.json:/migu/custom-channels.json
```

## 常见问题

**Q: 为什么保存后没有生效？**
A: 确认勾选了"启用自定义分组"选项。

**Q: 添加频道时提示"请先创建分组"？**
A: 需要先点击"新建分组"创建至少一个分组。

**Q: 频道名称不确定怎么办？**
A: 使用左侧的搜索框，或者先不启用自定义分组，查看完整的频道列表。

**Q: 可以一个频道添加到多个分组吗？**
A: 可以，同一个频道可以出现在多个分组中。

**Q: Docker 容器重启后配置会丢失吗？**
A: 默认会保存，但建议挂载配置文件以确保持久化。

**Q: 如何访问受密码保护的管理后台？**
A: 如果设置了 `mpass=mypassword`，访问地址为：`http://ip:port/mypassword/admin`

## 技术细节

### API 接口

管理后台使用以下 API：

- `GET /api/channels` - 获取所有频道数据
- `GET /api/config` - 获取当前配置
- `POST /api/config` - 保存配置

### 安全性

- 管理后台受 `mpass` 密码保护
- API 接口验证请求来源
- 配置文件存储在服务器本地

## 截图说明

### 主界面
- 左侧：所有频道列表，支持搜索
- 右侧：自定义分组管理
- 顶部：操作按钮和开关

### 操作流程
1. 创建分组 → 2. 添加频道 → 3. 保存配置 → 4. 启用分组

## 更新日志

### v1.0.0
- ✨ 首次发布 Web 管理后台
- 🎨 支持可视化频道分组
- 🔒 集成密码验证
- 💾 自动保存配置

---

**提示**：使用过程中如有问题，请查看控制台日志或提交 Issue。
